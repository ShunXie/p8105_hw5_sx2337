---
title: "p8105_hw5_sx2337"
author: "Shun Xie"
date: "2022-11-03"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#load packages
library(tidyverse)
library(dbplyr)
options(tibble.print_min = 5)
```

# Problem 1

```{r,show_col_types = FALSE}

All_files_names = list.files("data/")

All_files = 
  tibble(
    Name = str_remove(All_files_names, ".csv")) %>% 
  separate(Name, into = c("Control_Experiment","Index"), sep = "_") %>% 
  mutate(results =purrr::map(.x = str_c("data/",All_files_names), ~read_csv(.x, show_col_types = FALSE))) %>% 
  unnest(results) %>% 
  pivot_longer(
    cols = starts_with("week_"),
    names_to = "week_number",
    names_prefix = "week_",
    values_to = "value"
  ) %>% 
  ggplot(aes(x = week_number, y=value, group = Index))+
  geom_line(aes(color = Index)) + facet_grid(. ~ Control_Experiment)
All_files
```
Over the time, experiment group has a persistent increase over the week while the control group has value relatively stable values below 5.0. 



# Problem 2
```{r}
homocide_data = read_csv("data-homicides-master/homicide-data.csv", show_col_types = FALSE)
homocide_data
```

The data contains ```r length(homocide_data)``` number of columns corresponding to different variables:

uid is a variable that uniquely identify the homocide case. Reported date gives the data that the homocide case is reported. Victim information such as the person's last name, first name, race, age and sex are also included in the variables. City and State variable corresponds to the city and state that the homocide happens, as well as the exact location measured in latitude and longitude in lat and lon variables in the dataset. The disposition variable shows the current state of the case. There are ```r length(unique(homocide_data$disposition))``` unique status of disposition, namely ```r unique(homocide_data$disposition)```. 

```{r}
homocide_data_changed = 
  homocide_data %>%
  mutate(city_state = str_c(city, ", ", state))
```





